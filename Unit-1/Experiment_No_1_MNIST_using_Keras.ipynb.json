{"cells":[{"cell_type":"markdown","id":"b3c6521d","metadata":{"id":"b3c6521d"},"source":["\n","\n","\n","\n","\n","Import Libraries"]},{"cell_type":"code","execution_count":null,"id":"da787596","metadata":{"id":"da787596"},"outputs":[],"source":["import numpy as np\n","import tensorflow\n","import keras\n","from tensorflow import keras\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense, Dropout, Flatten\n","from tensorflow.keras.layers import Conv2D, MaxPooling2D"]},{"cell_type":"markdown","id":"71a9523b","metadata":{"id":"71a9523b"},"source":["Load the Dataset"]},{"cell_type":"code","execution_count":null,"id":"e2815b67","metadata":{"id":"e2815b67","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1762399363421,"user_tz":-330,"elapsed":412,"user":{"displayName":"BACKIYADHARSHAN V 23ADL192","userId":"15586347546058572160"}},"outputId":"20feb73a-9d09-4895-f590-344420f99a48"},"outputs":[{"output_type":"stream","name":"stdout","text":["Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz\n","\u001b[1m11490434/11490434\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 0us/step\n","(60000, 28, 28) (60000,)\n"]}],"source":["mnist = tensorflow.keras.datasets.mnist\n","(x_train, y_train), (x_test, y_test) = mnist.load_data()\n","print(x_train.shape, y_train.shape)"]},{"cell_type":"markdown","id":"75fa4d95","metadata":{"id":"75fa4d95"},"source":["Reshape the Data"]},{"cell_type":"code","execution_count":null,"id":"4a743afb","metadata":{"id":"4a743afb"},"outputs":[],"source":["x_train = x_train.reshape(x_train.shape[0], 28, 28, 1)\n","x_test = x_test.reshape(x_test.shape[0], 28, 28, 1)\n","input_shape = (28, 28, 1)"]},{"cell_type":"code","metadata":{"id":"52f559c3","colab":{"base_uri":"https://localhost:8080/"},"outputId":"5c6b7442-ae19-41fa-a518-68d1d28bfdf6"},"source":["import numpy as np\n","import tensorflow\n","import keras\n","from tensorflow import keras\n","from tensorflow.keras.models import Sequential\n","from tensorflow.keras.layers import Dense, Dropout, Flatten\n","from tensorflow.keras.layers import Conv2D, MaxPooling2D\n","\n","mnist = tensorflow.keras.datasets.mnist\n","(x_train, y_train), (x_test, y_test) = mnist.load_data()\n","\n","x_train = x_train.reshape(x_train.shape[0], 28, 28, 1)\n","x_test = x_test.reshape(x_test.shape[0], 28, 28, 1)\n","input_shape = (28, 28, 1)\n","\n","y_train = keras.utils.to_categorical(y_train, 10)\n","y_test = keras.utils.to_categorical(y_test, 10)\n","\n","x_train = x_train.astype('float32')\n","x_test = x_test.astype('float32')\n","x_train /= 255\n","x_test /= 255\n","\n","batch_size = 128\n","num_classes = 10\n","epochs = 30\n","\n","model = Sequential()\n","model.add(Conv2D(32, kernel_size=(5, 5), activation='relu', input_shape=input_shape))\n","model.add(MaxPooling2D(pool_size=(2, 2)))\n","model.add(Conv2D(64, (3, 3), activation='relu'))\n","model.add(MaxPooling2D(pool_size=(2, 2)))\n","model.add(Flatten())\n","model.add(Dense(128, activation='relu'))\n","model.add(Dropout(0.3))\n","model.add(Dense(64, activation='relu'))\n","model.add(Dropout(0.5))\n","model.add(Dense(num_classes, activation='softmax'))\n","\n","model.compile(loss=keras.losses.categorical_crossentropy,\n","              optimizer=keras.optimizers.Adadelta(),\n","              metrics=['accuracy'])\n","\n","hist = model.fit(x_train, y_train, batch_size=batch_size, epochs=epochs, verbose=1, validation_data=(x_test, y_test))\n","\n","score = model.evaluate(x_test, y_test, verbose=0)\n","\n","score = model.evaluate(x_test, y_test, verbose=1, sample_weight=None )\n","\n","# user to enter the index of the imag  e to predict\n","image_index = int(input(\"Enter the index of the image to predict (0-9999): \"))\n","\n","# Get the image from the test set\n","img = x_test[image_index]\n","\n","# Reshape the image to match the input_shape of the model\n","img_reshaped = img.reshape(1, 28, 28, 1)\n","\n","# Predict the class\n","prediction = model.predict(img_reshaped)\n","\n","# Get the index of the highest probability\n","predicted_class = np.argmax(prediction)\n","\n","import matplotlib.pyplot as plt\n","# Display the image and predicted class\n","plt.imshow(img.reshape(28, 28), cmap='gray')\n","plt.title(f'Predicted class: {predicted_class}')\n","plt.axis('off')\n","plt.show()"],"id":"52f559c3","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m9s\u001b[0m 13ms/step - accuracy: 0.0982 - loss: 2.3074 - val_accuracy: 0.1298 - val_loss: 2.2898\n","Epoch 2/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.1160 - loss: 2.2953 - val_accuracy: 0.1815 - val_loss: 2.2782\n","Epoch 3/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.1277 - loss: 2.2848 - val_accuracy: 0.2283 - val_loss: 2.2674\n","Epoch 4/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.1471 - loss: 2.2741 - val_accuracy: 0.2831 - val_loss: 2.2559\n","Epoch 5/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.1634 - loss: 2.2639 - val_accuracy: 0.3389 - val_loss: 2.2435\n","Epoch 6/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.1842 - loss: 2.2527 - val_accuracy: 0.3879 - val_loss: 2.2294\n","Epoch 7/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.1994 - loss: 2.2425 - val_accuracy: 0.4263 - val_loss: 2.2132\n","Epoch 8/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2159 - loss: 2.2287 - val_accuracy: 0.4577 - val_loss: 2.1947\n","Epoch 9/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2424 - loss: 2.2112 - val_accuracy: 0.4884 - val_loss: 2.1738\n","Epoch 10/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2517 - loss: 2.1966 - val_accuracy: 0.5202 - val_loss: 2.1508\n","Epoch 11/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2715 - loss: 2.1780 - val_accuracy: 0.5453 - val_loss: 2.1259\n","Epoch 12/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.2920 - loss: 2.1570 - val_accuracy: 0.5651 - val_loss: 2.0986\n","Epoch 13/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.3029 - loss: 2.1362 - val_accuracy: 0.5856 - val_loss: 2.0683\n","Epoch 14/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3156 - loss: 2.1122 - val_accuracy: 0.6001 - val_loss: 2.0339\n","Epoch 15/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3310 - loss: 2.0845 - val_accuracy: 0.6183 - val_loss: 1.9968\n","Epoch 16/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3431 - loss: 2.0577 - val_accuracy: 0.6376 - val_loss: 1.9575\n","Epoch 17/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3567 - loss: 2.0300 - val_accuracy: 0.6474 - val_loss: 1.9160\n","Epoch 18/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.3740 - loss: 1.9940 - val_accuracy: 0.6582 - val_loss: 1.8712\n","Epoch 19/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3813 - loss: 1.9658 - val_accuracy: 0.6713 - val_loss: 1.8245\n","Epoch 20/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3928 - loss: 1.9294 - val_accuracy: 0.6815 - val_loss: 1.7766\n","Epoch 21/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4029 - loss: 1.8947 - val_accuracy: 0.6926 - val_loss: 1.7273\n","Epoch 22/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4138 - loss: 1.8641 - val_accuracy: 0.7010 - val_loss: 1.6780\n","Epoch 23/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4310 - loss: 1.8210 - val_accuracy: 0.7118 - val_loss: 1.6270\n","Epoch 24/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.4402 - loss: 1.7808 - val_accuracy: 0.7197 - val_loss: 1.5757\n","Epoch 25/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4457 - loss: 1.7518 - val_accuracy: 0.7273 - val_loss: 1.5264\n","Epoch 26/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4586 - loss: 1.7161 - val_accuracy: 0.7366 - val_loss: 1.4776\n","Epoch 27/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4704 - loss: 1.6778 - val_accuracy: 0.7440 - val_loss: 1.4290\n","Epoch 28/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4829 - loss: 1.6436 - val_accuracy: 0.7526 - val_loss: 1.3814\n","Epoch 29/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.4891 - loss: 1.6186 - val_accuracy: 0.7605 - val_loss: 1.3364\n","Epoch 30/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.4990 - loss: 1.5815 - val_accuracy: 0.7662 - val_loss: 1.2920\n","\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 2ms/step - accuracy: 0.7464 - loss: 1.3401\n"]}]},{"cell_type":"markdown","id":"6b1ce8be","metadata":{"id":"6b1ce8be"},"source":["Convert Labels to Categorical"]},{"cell_type":"code","execution_count":null,"id":"d94d6c99","metadata":{"id":"d94d6c99"},"outputs":[],"source":["y_train = keras.utils.to_categorical(y_train, 10)\n","y_test = keras.utils.to_categorical(y_test, 10)"]},{"cell_type":"markdown","id":"256fe23a","metadata":{"id":"256fe23a"},"source":["Normalize the Data"]},{"cell_type":"code","execution_count":null,"id":"d06355ac","metadata":{"id":"d06355ac"},"outputs":[],"source":["x_train = x_train.astype('float32')\n","x_test = x_test.astype('float32')\n","x_train /= 255\n","x_test /= 255"]},{"cell_type":"markdown","id":"1bbf9d48","metadata":{"id":"1bbf9d48"},"source":["Print Shapes"]},{"cell_type":"code","execution_count":null,"id":"a3f60f70","metadata":{"id":"a3f60f70","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158559028,"user_tz":-330,"elapsed":16,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"6b19ac9f-914e-4b76-decc-a2c0a404324c"},"outputs":[{"output_type":"stream","name":"stdout","text":["x_train shape: (60000, 28, 28, 1)\n","60000 train samples\n","10000 test samples\n"]}],"source":["print('x_train shape:', x_train.shape)\n","print(x_train.shape[0], 'train samples')\n","print(x_test.shape[0], 'test samples')"]},{"cell_type":"markdown","id":"16769371","metadata":{"id":"16769371"},"source":["CNN Model: 1. Set Hyperparameters"]},{"cell_type":"code","execution_count":null,"id":"daf4c61a","metadata":{"id":"daf4c61a"},"outputs":[],"source":["batch_size = 128\n","num_classes = 10\n","epochs = 30"]},{"cell_type":"markdown","id":"65f5befe","metadata":{"id":"65f5befe"},"source":["Build the Model"]},{"cell_type":"code","execution_count":null,"id":"3412cf43","metadata":{"id":"3412cf43","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158561935,"user_tz":-330,"elapsed":2885,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"edf2d71b-d2b5-48c9-a22e-9678e1b82ff3"},"outputs":[{"output_type":"stream","name":"stderr","text":["/usr/local/lib/python3.11/dist-packages/keras/src/layers/convolutional/base_conv.py:107: UserWarning: Do not pass an `input_shape`/`input_dim` argument to a layer. When using Sequential models, prefer using an `Input(shape)` object as the first layer in the model instead.\n","  super().__init__(activity_regularizer=activity_regularizer, **kwargs)\n"]}],"source":["model = Sequential()\n","model.add(Conv2D(32, kernel_size=(5, 5), activation='relu', input_shape=input_shape))\n","model.add(MaxPooling2D(pool_size=(2, 2)))\n","model.add(Conv2D(64, (3, 3), activation='relu'))\n","model.add(MaxPooling2D(pool_size=(2, 2)))\n","model.add(Flatten())\n","model.add(Dense(128, activation='relu'))\n","model.add(Dropout(0.3))\n","model.add(Dense(64, activation='relu'))\n","model.add(Dropout(0.5))\n","model.add(Dense(num_classes, activation='softmax'))"]},{"cell_type":"markdown","id":"1e7dd244","metadata":{"id":"1e7dd244"},"source":["Compile the Model"]},{"cell_type":"code","execution_count":null,"id":"7ccf8b81","metadata":{"id":"7ccf8b81"},"outputs":[],"source":["model.compile(loss=keras.losses.categorical_crossentropy,\n","              optimizer=keras.optimizers.Adadelta(),\n","              metrics=['accuracy'])"]},{"cell_type":"markdown","id":"d87d9a69","metadata":{"id":"d87d9a69"},"source":["Train the Model"]},{"cell_type":"code","execution_count":null,"id":"720e94fd","metadata":{"id":"720e94fd","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158639982,"user_tz":-330,"elapsed":78020,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"27bc3c93-9479-41f7-ad95-23a208c9c86b"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m11s\u001b[0m 13ms/step - accuracy: 0.0964 - loss: 2.3039 - val_accuracy: 0.1139 - val_loss: 2.2916\n","Epoch 2/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.1093 - loss: 2.2934 - val_accuracy: 0.1613 - val_loss: 2.2793\n","Epoch 3/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.1266 - loss: 2.2823 - val_accuracy: 0.2291 - val_loss: 2.2672\n","Epoch 4/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 4ms/step - accuracy: 0.1454 - loss: 2.2726 - val_accuracy: 0.2859 - val_loss: 2.2539\n","Epoch 5/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.1615 - loss: 2.2609 - val_accuracy: 0.3212 - val_loss: 2.2389\n","Epoch 6/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.1809 - loss: 2.2482 - val_accuracy: 0.3560 - val_loss: 2.2226\n","Epoch 7/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 4ms/step - accuracy: 0.1957 - loss: 2.2346 - val_accuracy: 0.3880 - val_loss: 2.2051\n","Epoch 8/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2120 - loss: 2.2197 - val_accuracy: 0.4218 - val_loss: 2.1861\n","Epoch 9/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2191 - loss: 2.2069 - val_accuracy: 0.4521 - val_loss: 2.1648\n","Epoch 10/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 5ms/step - accuracy: 0.2387 - loss: 2.1854 - val_accuracy: 0.4721 - val_loss: 2.1403\n","Epoch 11/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2551 - loss: 2.1668 - val_accuracy: 0.4895 - val_loss: 2.1132\n","Epoch 12/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2687 - loss: 2.1429 - val_accuracy: 0.5019 - val_loss: 2.0836\n","Epoch 13/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 4ms/step - accuracy: 0.2834 - loss: 2.1189 - val_accuracy: 0.5129 - val_loss: 2.0512\n","Epoch 14/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.2963 - loss: 2.0966 - val_accuracy: 0.5204 - val_loss: 2.0161\n","Epoch 15/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.3087 - loss: 2.0680 - val_accuracy: 0.5257 - val_loss: 1.9788\n","Epoch 16/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 5ms/step - accuracy: 0.3252 - loss: 2.0378 - val_accuracy: 0.5336 - val_loss: 1.9390\n","Epoch 17/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3322 - loss: 2.0096 - val_accuracy: 0.5430 - val_loss: 1.8972\n","Epoch 18/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 4ms/step - accuracy: 0.3468 - loss: 1.9770 - val_accuracy: 0.5536 - val_loss: 1.8530\n","Epoch 19/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 4ms/step - accuracy: 0.3569 - loss: 1.9474 - val_accuracy: 0.5644 - val_loss: 1.8079\n","Epoch 20/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3728 - loss: 1.9045 - val_accuracy: 0.5728 - val_loss: 1.7603\n","Epoch 21/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.3840 - loss: 1.8700 - val_accuracy: 0.5825 - val_loss: 1.7128\n","Epoch 22/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.3970 - loss: 1.8385 - val_accuracy: 0.5928 - val_loss: 1.6653\n","Epoch 23/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4066 - loss: 1.8010 - val_accuracy: 0.6012 - val_loss: 1.6179\n","Epoch 24/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4230 - loss: 1.7688 - val_accuracy: 0.6130 - val_loss: 1.5713\n","Epoch 25/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4309 - loss: 1.7323 - val_accuracy: 0.6230 - val_loss: 1.5248\n","Epoch 26/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 5ms/step - accuracy: 0.4462 - loss: 1.6969 - val_accuracy: 0.6341 - val_loss: 1.4787\n","Epoch 27/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 5ms/step - accuracy: 0.4553 - loss: 1.6586 - val_accuracy: 0.6485 - val_loss: 1.4340\n","Epoch 28/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4688 - loss: 1.6270 - val_accuracy: 0.6615 - val_loss: 1.3900\n","Epoch 29/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m2s\u001b[0m 4ms/step - accuracy: 0.4754 - loss: 1.6031 - val_accuracy: 0.6742 - val_loss: 1.3488\n","Epoch 30/30\n","\u001b[1m469/469\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m3s\u001b[0m 4ms/step - accuracy: 0.4829 - loss: 1.5729 - val_accuracy: 0.6882 - val_loss: 1.3083\n","The model has successfully trained\n"]}],"source":["hist = model.fit(x_train, y_train, batch_size=batch_size, epochs=epochs, verbose=1, validation_data=(x_test, y_test))\n","print(\"The model has successfully trained\")"]},{"cell_type":"markdown","id":"da0995e0","metadata":{"id":"da0995e0"},"source":["Evaluate the Model"]},{"cell_type":"code","execution_count":null,"id":"81a5bc3b","metadata":{"id":"81a5bc3b","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158641379,"user_tz":-330,"elapsed":1385,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"f357a1d1-667e-4212-d560-c4a7b627591c"},"outputs":[{"output_type":"stream","name":"stdout","text":["Test loss: 1.3082517385482788\n","Test accuracy: 0.6881999969482422\n"]}],"source":["score = model.evaluate(x_test, y_test, verbose=0)\n","print('Test loss:', score[0])\n","print('Test accuracy:', score[1])"]},{"cell_type":"code","execution_count":null,"id":"ec7a7f59","metadata":{"id":"ec7a7f59","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158642455,"user_tz":-330,"elapsed":1079,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"67451409-4b54-44f9-fba0-8e0566e4974f"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[1m313/313\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 3ms/step - accuracy: 0.6744 - loss: 1.3631\n","Test loss: 1.3082517385482788\n","Test accuracy: 68.81999969482422\n"]}],"source":["score = model.evaluate(x_test, y_test, verbose=1, sample_weight=None )\n","print('Test loss:', score[0])\n","print('Test accuracy:', score[1]*100)"]},{"cell_type":"markdown","id":"7ca47c75","metadata":{"id":"7ca47c75"},"source":["Prediction"]},{"cell_type":"code","execution_count":null,"id":"7ac05967","metadata":{"id":"7ac05967","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158660459,"user_tz":-330,"elapsed":17986,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"afb82291-c213-4102-ad6b-b7b38341d452"},"outputs":[{"name":"stdout","output_type":"stream","text":["Enter the index of the image to predict (0-9999): 4\n"]}],"source":["# user to enter the index of the image to predict\n","image_index = int(input(\"Enter the index of the image to predict (0-9999): \"))"]},{"cell_type":"code","execution_count":null,"id":"1c95b089","metadata":{"id":"1c95b089"},"outputs":[],"source":["# Get the image from the test set\n","img = x_test[image_index]"]},{"cell_type":"code","execution_count":null,"id":"33ef963e","metadata":{"id":"33ef963e"},"outputs":[],"source":["# Reshape the image to match the input_shape of the model\n","img_reshaped = img.reshape(1, 28, 28, 1)"]},{"cell_type":"code","execution_count":null,"id":"f2c35ddc","metadata":{"id":"f2c35ddc","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158660944,"user_tz":-330,"elapsed":463,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"50c5ed05-c486-4538-92fa-bb50697e49be"},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[1m1/1\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m0s\u001b[0m 456ms/step\n"]}],"source":["# Predict the class\n","prediction = model.predict(img_reshaped)"]},{"cell_type":"code","execution_count":null,"id":"7f271487","metadata":{"id":"7f271487"},"outputs":[],"source":["# Get the index of the highest probability\n","predicted_class = np.argmax(prediction)"]},{"cell_type":"markdown","id":"19dc6e98","metadata":{"id":"19dc6e98"},"source":["Plot the digit"]},{"cell_type":"code","execution_count":null,"id":"32374876","metadata":{"id":"32374876","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1753158668129,"user_tz":-330,"elapsed":7151,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"027d6d0d-fd4d-4524-ae8f-1be9b4927f43"},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: matplotlib in /usr/local/lib/python3.11/dist-packages (3.10.0)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (1.3.2)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (4.59.0)\n","Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (1.4.8)\n","Requirement already satisfied: numpy>=1.23 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (2.0.2)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (25.0)\n","Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (11.3.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (3.2.3)\n","Requirement already satisfied: python-dateutil>=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib) (2.9.0.post0)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil>=2.7->matplotlib) (1.17.0)\n"]}],"source":["!pip install matplotlib\n"]},{"cell_type":"code","execution_count":null,"id":"a3e6d504","metadata":{"id":"a3e6d504","colab":{"base_uri":"https://localhost:8080/","height":428},"executionInfo":{"status":"ok","timestamp":1753158668143,"user_tz":-330,"elapsed":11,"user":{"displayName":"Jagan Balusamy","userId":"05348836718846471917"}},"outputId":"ec65031f-62dd-4509-c500-8565764a0bfb"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 640x480 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAYUAAAGbCAYAAAAr/4yjAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAAE1NJREFUeJzt3HuQVnX9wPHPIrILu6SguwriCGJKipcBsxITtxGURacmV2U0Q8yJUgQmMbtKgmZhOZoKQ01FNlQzXqgZM02mZUYaM7xVGDqEa2rMyE0cMhB39/z+cPiMKxf37MADP3m9Zvhjn+d8nvOFWXjv9zwPp6ooiiIAICJ67O0FALDvEAUAkigAkEQBgCQKACRRACCJAgBJFABIogBAEgUqavDgwXH55Zfn10uWLImqqqpYsmTJXlvTe713jfvKa0EliMJ+ZMGCBVFVVZW/ampq4thjj40pU6bEa6+9treXV8pDDz0U3/nOd/b2Mj7QxowZE1VVVTFlypS9vRQqqOfeXgCVN2vWrBgyZEhs2bIlli5dGvPmzYuHHnooli9fHn369KnoWs4888zYvHlz9OrVq9TcQw89FHfffbcw7CEPPPBAPP7443t7GewFdgr7oXHjxsXnPve5uPLKK2PBggUxffr0aG1tjd/97nc7nXnzzTf3yFp69OgRNTU10aOHb8V9xZYtW+Laa6+N66+/fm8vhb3A30TiU5/6VEREtLa2RkTE5ZdfHnV1dbFq1apoamqKvn37xqWXXhoRER0dHXH77bfHCSecEDU1NXHYYYfF5MmT4/XXX+/0mkVRxE033RSDBg2KPn36RGNjYzz33HPbnXtn7yk88cQT0dTUFP369Yva2to46aST4o477sj13X333RERnS6HbbO717gzHR0dcccdd8SJJ54YNTU1UV9fH+eee248+eSTO53ZsGFDzJgxI0488cSoq6uLD33oQzFu3Lj429/+tt2xd955Z5xwwgnRp0+f6NevX5x66qnxq1/9Kp/ftGlTTJ8+PQYPHhzV1dXR0NAQY8aMiaeffjqP+d///hfPP/98rFu3rsu/rzlz5kRHR0fMmDGjyzN8cLh8RKxatSoiIg455JB8rK2tLc4555w444wz4gc/+EFeVpo8eXIsWLAgJk2aFFOnTo3W1ta466674plnnok///nPceCBB0ZExA033BA33XRTNDU1RVNTUzz99NMxduzY2Lp16/uu59FHH43zzjsvBgwYENOmTYvDDz88VqxYEQ8++GBMmzYtJk+eHKtXr45HH300fvnLX243X4k1RkR84QtfiAULFsS4cePiyiuvjLa2tnjsscfiL3/5S5x66qk7nHnxxRfjt7/9bVx44YUxZMiQeO2112L+/PkxevTo+Oc//xkDBw6MiIif/OQnMXXq1Ghubo5p06bFli1b4u9//3s88cQTcckll0RExJe+9KW47777YsqUKXH88cfH+vXrY+nSpbFixYoYMWJERET89a9/jcbGxpg5c2aXLrW9/PLL8b3vfS9+9rOfRe/evbv058AHTMF+4+c//3kREcXixYuLtWvXFq+88krxm9/8pjjkkEOK3r17F6+++mpRFEUxceLEIiKKr33ta53mH3vssSIiioULF3Z6/OGHH+70+Jo1a4pevXoV48ePLzo6OvK4b3zjG0VEFBMnTszHWlpaiogoWlpaiqIoira2tmLIkCHFUUcdVbz++uudzvPu17r66quLHX377ok17sif/vSnIiKKqVOnbvfcu1/vqKOO6vRaW7ZsKdrb2zsd39raWlRXVxezZs3Kxz796U8XJ5xwwi7XcNBBBxVXX331Lo/Z9uc7c+bMXR63TXNzc3H66afn1xHxvufgg8Xlo/3Q2WefHfX19XHkkUfGhAkToq6uLhYtWhRHHHFEp+O+/OUvd/r63nvvjYMOOijGjBkT69aty18jR46Murq6aGlpiYiIxYsXx9atW+Oaa67pdFln+vTp77u2Z555JlpbW2P69Olx8MEHd3ru3a+1M5VYY0TE/fffH1VVVTFz5sztntvVOqurq/P9k/b29li/fn3U1dXFcccd1+myz8EHHxyvvvpqLFu2bKevdfDBB8cTTzwRq1ev3ukxZ511VhRF0aVdQktLS9x///1x++23v++xfHC5fLQfuvvuu+PYY4+Nnj17xmGHHRbHHXfcdm/09uzZMwYNGtTpsZUrV8Ybb7wRDQ0NO3zdNWvWRETEv//974iI+PCHP9zp+fr6+ujXr98u17btUtbw4cO7/huq8Bq3rXPgwIHRv3//Uuvb9j7E3Llzo7W1Ndrb2/O5d1++u/7662Px4sVx2mmnxTHHHBNjx46NSy65JEaNGpXHzJkzJyZOnBhHHnlkjBw5MpqamuLzn/98HH300aXWFPHO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\n"},"metadata":{}}],"source":["\n","import matplotlib.pyplot as plt\n","# Display the image and predicted class\n","plt.imshow(img.reshape(28, 28), cmap='gray')\n","plt.title(f'Predicted class: {predicted_class}')\n","plt.axis('off')\n","plt.show()"]},{"cell_type":"code","source":["! pip install balathon"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"hQ9bDzyfrS1S","executionInfo":{"status":"ok","timestamp":1762397495411,"user_tz":-330,"elapsed":5080,"user":{"displayName":"DHARANESH G S 23ADR031","userId":"08135518021789939891"}},"outputId":"b009fe0b-2d7f-489e-b79a-ed665c64f3d0"},"id":"hQ9bDzyfrS1S","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Collecting balathon\n","  Downloading balathon-0.0.4-py3-none-any.whl.metadata (194 bytes)\n","Downloading balathon-0.0.4-py3-none-any.whl (10 kB)\n","Installing collected packages: balathon\n","Successfully installed balathon-0.0.4\n"]}]},{"cell_type":"code","source":["from balathon import program\n","program(2)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"Dyp6DsCtrbA0","executionInfo":{"status":"ok","timestamp":1762397643855,"user_tz":-330,"elapsed":13,"user":{"displayName":"DHARANESH G S 23ADR031","userId":"08135518021789939891"}},"outputId":"f4d02a21-3094-4bbf-f8e6-97f15e72ae28"},"id":"Dyp6DsCtrbA0","execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["# Build a CNN model to perform Handwritten Number Recognition using Keras\n","\n","import numpy as np\n","from keras.datasets import mnist\n","from keras.models import Sequential, load_model\n","from keras.layers import Dense, Dropout, Flatten, Conv2D, MaxPooling2D\n","from keras import backend as K\n","\n","(x_train, y_train), (x_test, y_test) = mnist.load_data()\n","print(x_train.shape, y_train.shape)\n","\n","x_train = x_train.reshape(x_train.shape[0], 28, 28, 1)\n","x_test = x_test.reshape(x_test.shape[0], 28, 28, 1)\n","input_shape = (28, 28, 1)\n","\n","y_train = keras.utils.to_categorical(y_train, 10)\n","y_test = keras.utils.to_categorical(y_test, 10)\n","\n","x_train = x_train.astype('float32')\n","x_test = x_test.astype('float32')\n","x_train /= 255\n","x_test /= 255\n","\n","print('x_train shape:', x_train.shape)\n","print(x_train.shape[0], 'train samples')\n","print(x_test.shape[0], 'test samples')\n","\n","batch_size = 128\n","num_classes = 10\n","epochs = 1\n","\n","model = Sequential()\n","model.add(Conv2D(32, kernel_size=(5, 5), activation='relu', input_shape=input_shape))\n","model.add(MaxPooling2D(pool_size=(2, 2)))\n","model.add(Conv2D(64, (3, 3), activation='relu'))\n","model.add(MaxPooling2D(pool_size=(2, 2)))\n","model.add(Flatten())\n","model.add(Dense(128, activation='relu'))\n","model.add(Dropout(0.3))\n","model.add(Dense(64, activation='relu'))\n","model.add(Dropout(0.5))\n","model.add(Dense(num_classes, activation='softmax'))\n","\n","model.compile(loss=keras.losses.categorical_crossentropy,\n","              optimizer=keras.optimizers.Adadelta(),\n","              metrics=['accuracy'])\n","\n","hist = model.fit(x_train, y_train,\n","                 batch_size=batch_size,\n","                 epochs=epochs,\n","                 verbose=1,\n","                 validation_data=(x_test, y_test))\n","\n","print(\"The model has successfully trained\")\n","\n","score = model.evaluate(x_test, y_test, verbose=0)\n","print('Test loss:', score[0])\n","print('Test accuracy:', score[1])\n","\n","score = model.evaluate(x_test, y_test, verbose=1, sample_weight=None)\n","print('Test loss:', score[0])\n","print('Test accuracy:', score[1]*100)\n","\n","image_index = int(input(\"Enter the index of the image to predict (0-9999): \"))\n","img = x_test[image_index]\n","img_reshaped = img.reshape(1, 28, 28, 1)\n","prediction = model.predict(img_reshaped)\n","predicted_class = np.argmax(prediction)\n","\n","import matplotlib.pyplot as plt\n","plt.imshow(img.reshape(28, 28), cmap='gray')\n","plt.title(f'Predicted class: {predicted_class}')\n","plt.axis('off')\n","plt.show()\n","\n","\n","\n","\n","\n","\n","\n","\n","\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"V7jgDSaSEz-x"},"id":"V7jgDSaSEz-x","execution_count":null,"outputs":[]}],"metadata":{"kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.7.16"},"colab":{"provenance":[],"gpuType":"T4"},"accelerator":"GPU"},"nbformat":4,"nbformat_minor":5}